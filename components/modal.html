<link rel="import" href="../assets/vendor/polymer/polymer.html">

<dom-module id="bs-modal">
  <template>
    <!-- modal-dialog -->
    <div class="modal-dialog">
      <!-- modal content -->
      <div class="modal-content">
        <content></content>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary">Save changes</button>
        </div>
      </div>
      <!-- end modal-content -->
    </div>
    <!-- modal-dialog -->
  </template>
  <script>
    // element registration
    Polymer({
      is: "bs-modal",
      properties : {
        shown : {
          type: Boolean,
          value : false
        },
        backdrop : {
          type : Boolean,
          value : true
        }
      },
      listeners : {
        'transitionend' : 'test'
      },

      test : function(e){
        console.log(e);
        console.log('hello');
      },
      backdrop : function(callback){
        var self = this;
        var animate = this.classList.contains('fade') ? 'fade' : '';

        if( this.shown ){
          this.backdrop = document.createElement('div').classList.add('modal-backdrop' + animate);
          this.backdrop.appendTo(document.body);
        }
      },

      created : function(){
        this.classList.add('modal','fade');
        this.style.display = 'block';
      },
      show : function(){
        this.shown = true;
        document.body.classList.add('modal-open');
        this.classList.add('in');
        this.style.display = 'block';
        this.setAttribute('aria-hidden', false);


        var backdrop = document.createElement('div');
        backdrop.classList.add('modal-backdrop', 'fade', 'in');
        document.body.appendChild(backdrop);

      },
      hide : function(){
        this.shown = false;
        document.body.classList.remove('modal-open');
        this.classList.remove('in');
        this.style.display = 'none';
        this.setAttribute('aria-hidden', true);
      },
      toggle : function(){
        return this.shown ? this.hide() : this.show();
      },

      _measureScrollbar :function () { // thx walsh
        var scrollDiv = document.createElement('div')
        scrollDiv.className = 'modal-scrollbar-measure'
        this.$body.append(scrollDiv)
        var scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth
        this.$body[0].removeChild(scrollDiv)
        return scrollbarWidth
      }

    });
  </script>
</dom-module>

<dom-module id="bs-modal-header">
  <style>
    :host{
      display:block;
    }
  </style>
  <template>
    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
    <h4 class="modal-title">
      <content></content>
    </h4>
  </template>
  <script>
    // element registration
    Polymer({
      is: "bs-modal-header",
      created : function(){
        this.classList.add('modal-header');
      }
    });
  </script>
</dom-module>


<dom-module id="bs-modal-body">
  <style>
    :host{
      display:block;
    }
  </style>
  <template>
    <div class="modal-body">
      <content></content>
    </div>
  </template>
  <script>
    // element registration
    Polymer({
      is: "bs-modal-body",
      created : function(){
        this.classList.add('modal-body');
      }
    });
  </script>
</dom-module>

